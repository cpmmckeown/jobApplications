var utils={};var timer;utils.readCookie=function readCookie(cookie){var nameEQ=cookie+'=';var ca=document.cookie.split(';');var i;var c;for(i=0;i<ca.length;i++){c=ca[i];while(c.charAt(0)===' '){c=c.substring(1,c.length);}
if(c.indexOf(nameEQ)===0){return c.substring(nameEQ.length,c.length);}}
return null;};utils.logoutTimer=function readCookie(url){if(!timer){if(loggedin){timer=window.setInterval(function redirect(){if((utils.readCookie('loggedout')&&window.location.pathname!==url)||((!utils.readCookie('exp'))&&(window.location.pathname!==url))){window.onbeforeunload=null;window.location.assign(url);}},500);}}else{window.clearInterval(timer);}};utils.setCookie=function(name,value,days){var expires;if(days){var date=new Date();date.setTime(date.getTime()+(days*24*60*60*1000));expires='; expires='+date.toGMTString();}else{expires='';}
document.cookie=name+'='+value+expires+'; path=/';};var saved_dashboard_url='';function secure_block(secure_block_url,request){var result=$.Deferred();$.ajax({type:"OPTIONS",crossDomain:true,}).done(function(data,textStatus,xhr){xhr_secure_block(secure_block_url,request).done(result.resolve).fail(result.reject);}).fail(function(xhr,textStatus,error){jsonp_secure_block(secure_block_url,request).done(result.resolve).fail(result.reject);});return result.promise();}
function xhr_secure_block(secure_block_url,data){return $.ajax({url:secure_block_url,type:"POST",headers:{'X-Requested-With':'XMLHttpRequest'},data:JSON.stringify({'blocks':data}),contentType:"application/json",xhrFields:{withCredentials:true},});}
function jsonp_secure_block(secure_block_url,data){var json=JSON.stringify(data);return $.ajax({url:secure_block_url,type:"GET",dataType:"jsonp",data:{'blocks':json},});}
function populate_secure_blocks(request,callback){if(!$.isEmptyObject(request)){secure_block(saved_dashboard_url,request).fail(function(xhr,text,error){console.error("dashboard fail: ",xhr,text,error);}).done(function(data,text,xhr){$.each(data,function(key,value){$("[data-secure_block_id="+key+"]").html(value);});if(typeof callback==="function"){callback();}});}}
function load_secure_blocks(dashboard_url){saved_dashboard_url=dashboard_url;var request={};$("*[data-secure_block_id]").each(function(i,block){var element_id=$(block).data('secure_block_id');request[element_id]=$(block).data();});populate_secure_blocks(request);}
function reload_secure_block(block_id,callback){var request={};var block=$("[data-secure_block_id="+block_id+"]");if(block){request[block_id]=block.data();populate_secure_blocks(request,callback);}}
$(document).ready(function(){$.ui.autocomplete.prototype._renderItem=function(ul,item){var term=this.term
if((term.charAt(0)=='"'&&term.charAt(term.length-1)=='"')){term=this.term.substr(1,term.length-2);}else{term=this.term.split(' ').join('|');}
var re=new RegExp("("+term+")","gi");var t=item.label.replace(re,"<b class='ac-highlight'>$1</b>");return $("<li></li>").data("item.autocomplete",item).append("<a>"+t+"</a>").appendTo(ul);};$("#standardSearch input[type=text]").bind("autocompleteselect",function(event,ul){$(this).val(ul.item.value);if($('#moc').length>0){if($('#location').val()!=""&&$('#q').val()!=""&&$('#moc').val()!=""){$("#standardSearch").submit();}}
else{if($('#location').val()!=""&&$('#q').val()!=""){$("#standardSearch").submit();}}});$(".micrositeLocationField").autocomplete({source:function(request,response){$.ajax({url:"/ajax/ac/?lookup=location&term="+request.term,dataType:"jsonp",success:function(data){response($.map(data,function(item){return{label:item.location+" - ("+item.jobcount+")",value:item.location};}));}});},open:function(event,ul){$(".ui-autocomplete li.ui-menu-item:odd").addClass("ui-menu-item-alternate");},minLength:2});$(".micrositeTitleField").autocomplete({source:function(request,response){$.ajax({url:"/ajax/ac/?lookup=title&term="+request.term,dataType:"jsonp",success:function(data){response($.map(data,function(item){return{label:item.title,value:item.title};}));}});},open:function(event,ul){$(".ui-autocomplete li.ui-menu-item:odd").addClass("ui-menu-item-alternate");$(".ui-autocomplete li.ui-menu-item a").removeClass("ui-corner-all");},select:function(event,ui){$(".micrositeTitleField").val('"'+ui.item.value+'"');return false;},minLength:2});$(".micrositeMOCField").autocomplete({source:function(request,response){$.ajax({url:"/ajax/mac/?lookup=moc&term="+request.term,dataType:"jsonp",success:function(data){response($.map(data,function(item){return{label:item.label,value:item.value,moc_id:item.moc_id};}));}});},select:function(event,ui){$("#moc_id").val(ui.item.moc_id);},open:function(event,ul){$(".ui-autocomplete li.ui-menu-item:odd").addClass("ui-menu-item-alternate");},minLength:2});$("#moc").change(function(event){$("#moc_id").val("");});});